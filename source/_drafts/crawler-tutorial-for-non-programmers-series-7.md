---
title: 给非程序员的爬虫教程（七）：HTTP 协议与 Web 基础概念
tags:
  - python
  - 非程序员的爬虫教程
---

爬虫程序设计的初衷，就是让程序来替代人来获取数据。人获取数据一般都是通过浏览器，爬虫也就是**模拟浏览器获取数据**。具体的说，我们需要模拟的就是从地址栏输入网址到浏览器拿到数据的过程。为此，我们需要先要引入一系列的基础概念。

## URL
我们平时输入的网址，是一种**统一资源定位符(Uniform Resource Locator)**，简称 URL。它有一套标准的格式：
```
协议类型:[//服务器地址[:端口号]][/资源层级UNIX文件路径]文件名[?查询][#片段ID]
```
以`https://en.wikipedia.org/w/index.php?title=URL`为例：
1. 协议类型(protocol)为`https`
2. 服务器地址/域名(domain)是`en.wikipedia.org`
3. 端口号(port)这里已经省略了，对于 https 来讲默认是`443`
4. 路径(path)为`/w/index.php`
5. 查询(search)为`?title=URL`（以`?`为起点，每个参数用`&`隔开，用`=`分隔参数和名称）

大部分浏览器中，浏览器并不强制要求我们输入协议类型，默认为 http（同时默认端口是80）。服务器可以根据我们的 URL 来推断需要返回给我们的资源。注意，即使 url 完全相同，服务器返回给我们的内容可能也有所不同，这和我们的请求中其它的参数，以及服务器的逻辑决定。

## HTTP 与 HTTPS
HTTP(HyperText Transfer Protocol，超文本传输协议)是在 Web 中最常见的通信协议，它的整个通信过程，我们可以简化为“发送请求，得到响应”：

[示例图]

输入网址后，HTTP 客户端(通常是浏览器，或者是我们的爬虫程序)会通过这个网址找到对应的**服务器(server)**，并将对应的数据发送过去，这一过程我们通常称之为**请求(request)**。服务器会根据我们输入的路径，通过一系列的计算，返回给我们对应的数据，这一过程我们称之为**响应(response)**。我们将分别从请求和响应两方面来详细介绍下 HTTP 协议。

### HTTP 请求
#### 请求方法
HTTP 协议中定义一系列的方法，来方便客户端以不同方式操作 URL 定位到的对应资源。
1. GET：“读取”对应的资源。一般情况下，GET 请求不应当产生“副作用”，即不会对服务器资源产生影响。
2. HEAD：和 GET 类似，HEAD 请求也是获取指定资源的请求。和 GET 不同的是，HEAD 只需要该资源的 HTTP 头信息（元信息）。
3. POST：向服务器提交数据，并请求服务器进行处理。
4. PUT：向服务器上传新内容。
5. DELETE：请求服务器删除对应资源。
6. TRACE：显示服务器收到的请求（一般用于测试）。
7. OPTIONS：使服务器返回所有支持的 HTTP 方法。
8. CONNECT：和服务器建立双向连接。
9. PATCH： 局部更新对应资源。  

在上文列出的方法中，最常用的是 GET 和 POST。需要注意的是：上文对这些方法的作用，仅仅是一种约定，具体的实现还是要看服务器端的具体实现。然而，很多服务器端的实现并不规范，我们写爬虫时，只需将请求方法保持和网页端的请求保持一致即可。

#### 请求头

### HTTP 响应
#### 状态码
HTTP 的响应状态码是一个三位数字，描述了当前返回响应的状态。例如我们常见的 404，表示页面不存在；200 表示请求成功等等。状态码的第一位，标识了该状态所属的类型：
1. 1xx —— 请求已被服务器接收，继续处理
2. 2xx —— 请求已成功被服务器接收、理解、并接受
3. 3xx —— 需要后续操作才能完成这一请求
4. 4xx —— 请求含有词法错误或者无法被执行
5. 5xx —— 服务器在处理某个正确请求时发生错误

下面列举几个常见的错误码：
* 200(OK): 请求成功
* 301(Moved Permanently)：请求重定向(永久)
* 302(Moved Temporarily)：请求重定向(临时)
* 400(Bad Request): 请求格式有错误，服务器不能处理
* 403(Forbidden): 服务器拒绝执行该请求(一般是权限不足)
* 404(Not Found): 资源未找到
* 500(Server Internal Error): 服务器异常

#### 响应头
和 HTTP 请求类似，HTTP 响应也有头部。不过大多数响应头都是自定义的，而且我们需要的信息，多数也不在响应头内，下面只简单列出两个常见的响应头`Content-Length`和`Content-Type`：
* Content-Length: 请求体的长度
* Content-Type: 返回的请求体类型。例如`text/javascript`,`text/html`,`image/png`,`image/jpeg` 等等。

#### 响应体
HTTP 响应体就是我们拿到的数据，它有可能是文本/脚本，也有可能是二进制数据（例如图片）等等。

### SSL
HTTPS 的通信过程和 HTTP 完全一致，不同的是它传输的数据都是加密的。它利用一种特殊的算法(RSA 加密算法)，保证只有发出方能够解密出 HTTP 的信息。这一过程，在底层已经做了处理，我们的上层应用不感知，在我们编写爬虫或网站时，就默认 HTTP 和 HTTPS 传输的信息格式一致即可。

## HTML、CSS 与 Javascript

## 扩展阅读
1. [维基百科：统一资源标志符(URI)](https://zh.wikipedia.org/wiki/%E7%BB%9F%E4%B8%80%E8%B5%84%E6%BA%90%E6%A0%87%E5%BF%97%E7%AC%A6)
2. [维基百科：统一资源定位符(URL)](https://zh.wikipedia.org/wiki/%E7%BB%9F%E4%B8%80%E8%B5%84%E6%BA%90%E5%AE%9A%E4%BD%8D%E7%AC%A6)
3. [维基百科：超文本传输协议(HTTP)](https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE)
4. [维基百科: 超文本传输安全协议(HTTPS)](https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE)
5. [维基百科：HTTP状态码](https://zh.wikipedia.org/wiki/HTTP%E7%8A%B6%E6%80%81%E7%A0%81)